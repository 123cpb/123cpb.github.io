<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shadowboxing Combo Generator - 6 Round System</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            color: white;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            flex-grow: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 2px 2px 4px rgba(0,0,0,0.3), 0 0 10px rgba(255,255,255,0.2); }
            to { text-shadow: 2px 2px 4px rgba(0,0,0,0.3), 0 0 20px rgba(255,255,255,0.4); }
        }

        .training-modes {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .mode-btn {
            flex: 1;
            min-width: 200px;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .mode-btn.active {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            transform: translateY(-2px);
        }

        .mode-btn:not(.active) {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .mode-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .round-info {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            text-align: center;
        }

        .round-title {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 10px;
            color: #ffeb3b;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .round-description {
            font-size: 1.1em;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .round-progress {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        .round-dot {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            border: 2px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.1);
            transition: all 0.3s ease;
        }

        .round-dot.completed {
            background: linear-gradient(45deg, #4caf50, #45a049);
            border-color: #4caf50;
            transform: scale(1.1);
        }

        .round-dot.current {
            background: linear-gradient(45deg, #ffeb3b, #ffc107);
            border-color: #ffeb3b;
            color: #333;
            animation: pulse 1s infinite;
        }

        .controls {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        label {
            font-weight: bold;
            min-width: 120px;
        }

        input, select, button {
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        input, select {
            background: rgba(255,255,255,0.9);
            color: #333;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
        }

        input:focus, select:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(255,255,255,0.3);
            transform: scale(1.02);
        }

        button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            filter: brightness(1.1);
        }

        button:active {
            transform: translateY(-1px);
        }

        button:disabled {
            background: linear-gradient(45deg, #666, #555);
            cursor: not-allowed;
            transform: none;
            filter: none;
        }

        .combo-display {
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            border: 2px solid rgba(255,255,255,0.3);
            margin-bottom: 30px;
            box-shadow: inset 0 4px 20px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
        }

        .combo-display::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            50% { transform: translateX(100%) translateY(100%) rotate(45deg); }
            100% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
        }

        .combo-text {
            font-size: 2em;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 20px;
            position: relative;
            z-index: 2;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        .timer {
            font-size: 1.5em;
            color: #ffeb3b;
            font-weight: bold;
            position: relative;
            z-index: 2;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .combo-management {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }

        .combo-list {
            max-height: 250px;
            overflow-y: auto;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .combo-list::-webkit-scrollbar {
            width: 8px;
        }

        .combo-list::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
        }

        .combo-list::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
        }

        .combo-item {
            background: rgba(255,255,255,0.1);
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .combo-item:hover {
            background: rgba(255,255,255,0.2);
            transform: translateX(5px);
        }

        .delete-btn {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.2s ease;
        }

        .delete-btn:hover {
            background: linear-gradient(45deg, #c0392b, #a93226);
            transform: scale(1.1);
        }

        .status {
            text-align: center;
            margin-top: 15px;
            font-weight: bold;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            min-height: 20px;
        }

        .training-mode {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { border-color: rgba(255,255,255,0.3); }
            50% { border-color: rgba(255,235,59,0.8); }
        }

        .round-timer {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
        }

        .round-timer-display {
            font-size: 2em;
            font-weight: bold;
            color: #ffeb3b;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            min-width: 120px;
        }

        .defensive {
            border-left: 4px solid #2196f3 !important;
        }

        .intermediate {
            border-left: 4px solid #ff9800 !important;
        }

        .aggressive {
            border-left: 4px solid #f44336 !important;
        }

        @media (max-width: 600px) {
            .control-group {
                flex-direction: column;
                align-items: stretch;
            }

            label {
                min-width: auto;
            }

            .combo-text {
                font-size: 1.5em;
            }

            .header h1 {
                font-size: 2em;
            }

            .training-modes {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü•ä 6-Round Shadowboxing System</h1>
            <p>Progressive training from defensive fundamentals to aggressive combinations</p>
        </div>

        <div class="training-modes">
            <button class="mode-btn active" onclick="setTrainingMode('rounds')">
                ü•ä 6-Round System
            </button>
            <button class="mode-btn" onclick="setTrainingMode('custom')">
                ‚öôÔ∏è Custom Training
            </button>
        </div>

        <div id="roundInfo" class="round-info">
            <div class="round-title">Round 1: Defensive Fundamentals</div>
            <div class="round-description">Focus on straight punches, pulls, and slips. Build your defensive foundation.</div>
            <div class="round-progress">
                <div class="round-dot current">1</div>
                <div class="round-dot">2</div>
                <div class="round-dot">3</div>
                <div class="round-dot">4</div>
                <div class="round-dot">5</div>
                <div class="round-dot">6</div>
            </div>
        </div>

        <div class="controls">
            <div class="control-group" id="roundControls">
                <label for="roundDuration">Round Duration (minutes):</label>
                <input type="number" id="roundDuration" value="3" min="1" max="10">
                <label for="restDuration">Rest Between Rounds (seconds):</label>
                <input type="number" id="restDuration" value="60" min="30" max="180">
            </div>
            <div class="control-group" id="customControls" style="display: none;">
                <label for="intervalMode">Timing Mode:</label>
                <select id="intervalMode" onchange="toggleIntervalMode()">
                    <option value="fixed">Fixed Interval</option>
                    <option value="random">Random Interval (2-10s)</option>
                    <option value="custom-random">Custom Random Range</option>
                </select>
            </div>
            <div class="control-group" id="fixedIntervalGroup" style="display: none;">
                <label for="interval">Display Time (seconds):</label>
                <input type="number" id="interval" value="5" min="1" max="60">
            </div>
            <div class="control-group" id="randomIntervalGroup" style="display: none;">
                <label for="minInterval">Min Time (seconds):</label>
                <input type="number" id="minInterval" value="2" min="1" max="30">
                <label for="maxInterval">Max Time (seconds):</label>
                <input type="number" id="maxInterval" value="10" min="2" max="60">
            </div>
            <div class="control-group">
                <button id="startBtn" onclick="startTraining()">üöÄ Start Training</button>
                <button id="stopBtn" onclick="stopTraining()" disabled>‚èπÔ∏è Stop Training</button>
                <button onclick="showNextCombo()">‚è≠Ô∏è Next Combo</button>
                <button id="nextRoundBtn" onclick="nextRound()" style="display: none;">‚è≠Ô∏è Next Round</button>
            </div>
        </div>

        <div class="combo-display" id="comboDisplay">
            <div class="combo-text" id="comboText">Ready to train! Select your training mode and hit Start Training.</div>
            <div class="timer" id="timer"></div>
            <div class="round-timer" id="roundTimer" style="display: none;">
                <div>Round Time:</div>
                <div class="round-timer-display" id="roundTimeDisplay">3:00</div>
            </div>
        </div>

        <div class="combo-management" id="customComboManagement" style="display: none;">
            <h3>ü•ä Manage Your Combos</h3>
            <div class="control-group">
                <input type="text" id="newCombo" placeholder="Enter a new combo (e.g., Lead Jab-Rear Cross-Lead Hook)" style="flex-grow: 1;">
                <button onclick="addCombo()">‚ûï Add Combo</button>
            </div>
            <div class="control-group">
                <button onclick="resetCombos()">üîÑ Reset to Defaults</button>
                <button onclick="exportCombos()">üì§ Export Combos</button>
                <button onclick="showImportDialog()">üì• Import Combos</button>
            </div>
            <div class="combo-list" id="comboList"></div>
            <div class="status" id="status"></div>
        </div>
    </div>

    <script>
        class EnhancedComboGenerator {
            constructor() {
                this.roundCombos = {
                    1: { // Defensive Fundamentals
                        combos: [
                            "Lead Jab",
                            "Rear Cross", 
                            "Lead Jab - Pull Back",
                            "Rear Cross - Slip Left",
                            "Lead Jab - Rear Cross",
                            "Double Lead Jab",
                            "Lead Jab - Slip Right",
                            "Rear Cross - Pull Back",
                            "Lead Jab - Rear Cross - Pull Back",
                            "Slip Left - Lead Jab",
                            "Pull Back - Rear Cross",
                            "Lead Jab - Slip Left - Rear Cross"
                        ],
                        description: "Defensive Fundamentals",
                        focus: "Focus on straight punches, pulls, and slips. Build your defensive foundation.",
                        type: "defensive"
                    },
                    2: { // Advanced Defense
                        combos: [
                            "Double Lead Jab - Rear Cross",
                            "Lead Jab - Rear Cross - Lead Jab",
                            "Slip Right - Rear Cross - Pull Back",
                            "Pull Back - Lead Jab - Rear Cross",
                            "Lead Jab - Slip Left - Rear Cross - Pull Back",
                            "Rear Cross - Slip Right - Lead Jab",
                            "Double Lead Jab - Slip Left",
                            "Lead Jab - Pull Back - Rear Cross - Slip Right",
                            "Slip Left - Lead Jab - Rear Cross - Pull Back",
                            "Rear Cross - Pull Back - Lead Jab - Slip Left",
                            "Lead Jab - Rear Cross - Slip Right - Lead Jab",
                            "Pull Back - Double Lead Jab - Rear Cross"
                        ],
                        description: "Advanced Defense",
                        focus: "Building on defensive fundamentals with longer combinations and better footwork.",
                        type: "defensive"
                    },
                    3: { // Adding Power Shots
                        combos: [
                            "Lead Jab - Rear Cross - Lead Hook",
                            "Lead Hook - Rear Cross",
                            "Lead Jab - Lead Uppercut - Rear Cross",
                            "Rear Cross - Lead Hook - Roll Right",
                            "Lead Hook - Rear Uppercut",
                            "Roll Left - Lead Hook - Rear Cross",
                            "Lead Jab - Rear Cross - Lead Hook - Rear Cross",
                            "Lead Uppercut - Rear Cross - Lead Hook",
                            "Roll Right - Rear Uppercut - Lead Hook",
                            "Lead Hook - Roll Left - Rear Cross",
                            "Lead Jab - Lead Hook - Rear Uppercut",
                            "Rear Cross - Roll Right - Lead Uppercut - Rear Cross"
                        ],
                        description: "Adding Power Shots",
                        focus: "Introducing hooks, uppercuts, and rolls. Start building power combinations.",
                        type: "intermediate"
                    },
                    4: { // Combination Flow
                        combos: [
                            "Lead Hook - Rear Cross - Lead Hook - Roll Left",
                            "Lead Jab - Rear Uppercut - Lead Hook - Rear Cross",
                            "Roll Right - Lead Uppercut - Rear Cross - Lead Hook",
                            "Lead Hook - Rear Uppercut - Roll Right - Lead Jab",
                            "Rear Cross - Lead Hook - Rear Uppercut - Roll Left",
                            "Lead Uppercut - Roll Left - Rear Cross - Lead Hook",
                            "Lead Hook - Roll Right - Rear Uppercut - Lead Hook",
                            "Roll Left - Lead Jab - Rear Cross - Lead Hook - Rear Uppercut",
                            "Lead Jab - Lead Uppercut - Roll Right - Rear Cross - Lead Hook",
                            "Rear Cross - Roll Left - Lead Hook - Rear Uppercut - Lead Jab",
                            "Lead Hook - Rear Cross - Roll Right - Lead Uppercut - Rear Cross",
                            "Roll Left - Rear Uppercut - Lead Hook - Rear Cross - Roll Right"
                        ],
                        description: "Combination Flow", 
                        focus: "Flowing combinations with hooks, uppercuts, and defensive rolls. Build rhythm.",
                        type: "intermediate"
                    },
                    5: { // High Volume Aggression
                        combos: [
                            "Lead Jab - Rear Cross - Lead Hook - Rear Cross - Lead Uppercut",
                            "Lead Hook - Rear Uppercut - Lead Hook - Rear Cross - Lead Jab - Rear Cross",
                            "Rear Cross - Lead Hook - Rear Uppercut - Lead Hook - Rear Cross",
                            "Lead Jab - Lead Hook - Rear Cross - Lead Uppercut - Rear Uppercut - Lead Hook",
                            "Lead Uppercut - Rear Cross - Lead Hook - Rear Uppercut - Lead Jab - Rear Cross",
                            "Rear Cross - Lead Hook - Rear Cross - Lead Uppercut - Rear Uppercut",
                            "Lead Hook - Rear Cross - Lead Hook - Rear Uppercut - Lead Hook - Rear Cross",
                            "Lead Jab - Rear Cross - Lead Jab - Lead Hook - Rear Uppercut - Lead Hook",
                            "Rear Uppercut - Lead Hook - Rear Cross - Lead Hook - Rear Cross - Lead Uppercut",
                            "Lead Hook - Lead Uppercut - Rear Cross - Lead Hook - Rear Uppercut - Rear Cross",
                            "Lead Jab - Lead Hook - Rear Cross - Lead Uppercut - Lead Hook - Rear Cross - Lead Jab",
                            "Rear Cross - Lead Hook - Rear Uppercut - Lead Hook - Rear Cross - Lead Uppercut - Rear Cross"
                        ],
                        description: "High Volume Aggression",
                        focus: "Aggressive, high-volume combinations. Push the pace with continuous punching.",
                        type: "aggressive"
                    },
                    6: { // Championship Rounds
                        combos: [
                            "Lead Jab - Rear Cross - Lead Hook - Rear Uppercut - Lead Hook - Rear Cross - Lead Uppercut",
                            "Rear Cross - Lead Hook - Rear Cross - Lead Uppercut - Rear Uppercut - Lead Hook - Rear Cross",
                            "Lead Hook - Rear Uppercut - Lead Hook - Rear Cross - Lead Hook - Rear Uppercut - Lead Jab - Rear Cross",
                            "Lead Jab - Lead Hook - Rear Cross - Lead Hook - Rear Uppercut - Lead Hook - Rear Cross - Lead Uppercut",
                            "Rear Uppercut - Lead Hook - Rear Cross - Lead Uppercut - Lead Hook - Rear Cross - Lead Hook - Rear Uppercut",
                            "Lead Hook - Lead Uppercut - Rear Cross - Lead Hook - Rear Uppercut - Lead Hook - Rear Cross - Lead Hook",
                            "Rear Cross - Lead Hook - Rear Uppercut - Lead Hook - Rear Cross - Lead Uppercut - Rear Uppercut - Lead Hook",
                            "Lead Jab - Rear Cross - Lead Hook - Lead Uppercut - Rear Cross - Lead Hook - Rear Uppercut - Lead Hook - Rear Cross",
                            "Lead Hook - Rear Cross - Lead Hook - Rear Uppercut - Lead Hook - Rear Cross - Lead Uppercut - Rear Uppercut",
                            "Rear Cross - Lead Hook - Lead Uppercut - Rear Cross - Lead Hook - Rear Uppercut - Lead Hook - Rear Cross - Lead Hook",
                            "Lead Uppercut - Lead Hook - Rear Cross - Lead Hook - Rear Uppercut - Lead Hook - Rear Cross - Lead Uppercut - Rear Cross",
                            "Lead Hook - Rear Uppercut - Lead Hook - Rear Cross - Lead Hook - Rear Uppercut - Lead Jab - Rear Cross - Lead Hook - Rear Cross"
                        ],
                        description: "Championship Rounds",
                        focus: "Maximum aggression and volume. Fight like a champion with complex, high-output combinations.",
                        type: "aggressive"
                    }
                };

                this.customCombos = this.loadCombos();
                this.currentRound = 1;
                this.completedRounds = [];
            }

            loadCombos() {
                const defaultCombos = [
                    "Lead Jab - Rear Cross",
                    "Lead Jab - Rear Cross - Lead Hook",
                    "Lead Hook - Rear Cross - Lead Hook",
                    "Lead Uppercut - Rear Cross - Lead Hook",
                    "Lead Jab - Lead Uppercut - Rear Cross",
                    "Double Lead Jab - Rear Cross",
                    "Lead Jab - Rear Cross - Lead Uppercut - Lead Hook"
                ];

                try {
                    const saved = localStorage.getItem('shadowboxing-combos');
                    if (saved) {
                        const parsed = JSON.parse(saved);
                        return parsed.length > 0 ? parsed : [...defaultCombos];
                    }
                } catch (e) {
                    console.warn('Could not load saved combos:', e);
                }
                return [...defaultCombos];
            }

            saveCombos() {
                try {
                    localStorage.setItem('shadowboxing-combos', JSON.stringify(this.customCombos));
                    return true;
                } catch (e) {
                    console.warn('Could not save combos:', e);
                    return false;
                }
            }

            addCombo(combo) {
                if (combo && combo.trim() && !this.customCombos.includes(combo.trim())) {
                    this.customCombos.push(combo.trim());
                    this.saveCombos();
                    return true;
                }
                return false;
            }

            removeCombo(combo) {
                const index = this.customCombos.indexOf(combo);
                if (index > -1 && this.customCombos.length > 1) {
                    this.customCombos.splice(index, 1);
                    this.saveCombos();
                    return true;
                }
                return false;
            }

            getRandomCombo(mode = 'custom') {
                if (mode === 'rounds') {
                    const roundData = this.roundCombos[this.currentRound];
                    if (!roundData || roundData.combos.length === 0) {
                        return "No combos available for this round";
                    }
                    return roundData.combos[Math.floor(Math.random() * roundData.combos.length)];
                } else {
                    if (this.customCombos.length === 0) {
                        return "No combos available";
                    }
                    return this.customCombos[Math.floor(Math.random() * this.customCombos.length)];
                }
            }

            getCurrentRoundInfo() {
                return this.roundCombos[this.currentRound] || null;
            }

            nextRound() {
                if (this.currentRound < 6) {
                    this.completedRounds.push(this.currentRound);
                    this.currentRound++;
                    return true;
                }
                return false;
            }

            resetRounds() {
                this.currentRound = 1;
                this.completedRounds = [];
            }

            getAllCombos() {
                return [...this.customCombos];
            }

            getComboCount() {
                return this.customCombos.length;
            }

            resetToDefaults() {
                const defaultCombos = [
                    "Lead Jab - Rear Cross",
                    "Lead Jab - Rear Cross - Lead Hook",
                    "Lead Hook - Rear Cross - Lead Hook",
                    "Lead Uppercut - Rear Cross - Lead Hook",
                    "Lead Jab - Lead Uppercut - Rear Cross",
                    "Double Lead Jab - Rear Cross",
                    "Lead Jab - Rear Cross - Lead Uppercut - Lead Hook"
                ];
                this.customCombos = [...defaultCombos];
                this.saveCombos();
                return true;
            }

            exportCombos() {
                return JSON.stringify(this.customCombos, null, 2);
            }

            importCombos(jsonString) {
                try {
                    const imported = JSON.parse(jsonString);
                    if (Array.isArray(imported) && imported.length > 0) {
                        this.customCombos = imported.filter(combo => typeof combo === 'string' && combo.trim());
                        if (this.customCombos.length === 0) {
                            this.resetToDefaults();
                        }
                        this.saveCombos();
                        return true;
                    }
                } catch (e) {
                    console.warn('Could not import combos:', e);
                }
                return false;
            }
        }

        const generator = new EnhancedComboGenerator();
        let isTraining = false;
        let trainingInterval;
        let countdownInterval;
        let roundTimer;
        let timeLeft = 0;
        let currentIntervalDuration = 0;
        let currentTrainingMode = 'rounds';
        let roundTimeLeft = 0;
        let isResting = false;

        function setTrainingMode(mode) {
            currentTrainingMode = mode;
            
            // Update UI
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            if (mode === 'rounds') {
                document.getElementById('roundInfo').style.display = 'block';
                document.getElementById('roundControls').style.display = 'flex';
                document.getElementById('customControls').style.display = 'none';
                document.getElementById('fixedIntervalGroup').style.display = 'none';
                document.getElementById('randomIntervalGroup').style.display = 'none';
                document.getElementById('customComboManagement').style.display = 'none';
                document.getElementById('roundTimer').style.display = 'flex';
                updateRoundDisplay();
            } else {
                document.getElementById('roundInfo').style.display = 'none';
                document.getElementById('roundControls').style.display = 'none';
                document.getElementById('customControls').style.display = 'flex';
                document.getElementById('customComboManagement').style.display = 'block';
                document.getElementById('roundTimer').style.display = 'none';
                toggleIntervalMode();
                updateComboList();
                updateStatus();
            }
            
            if (isTraining) {
                stopTraining();
            }
        }

        function updateRoundDisplay() {
            const roundInfo = generator.getCurrentRoundInfo();
            if (!roundInfo) return;

            document.querySelector('.round-title').textContent = `Round ${generator.currentRound}: ${roundInfo.description}`;
            document.querySelector('.round-description').textContent = roundInfo.focus;

            // Update round progress dots
            const dots = document.querySelectorAll('.round-dot');
            dots.forEach((dot, index) => {
                const roundNum = index + 1;
                dot.classList.remove('completed', 'current');
                
                if (generator.completedRounds.includes(roundNum)) {
                    dot.classList.add('completed');
                } else if (roundNum === generator.currentRound) {
                    dot.classList.add('current');
                }
            });

            // Update combo display background based on round type
            const comboDisplay = document.getElementById('comboDisplay');
            comboDisplay.classList.remove('defensive', 'intermediate', 'aggressive');
            comboDisplay.classList.add(roundInfo.type);
        }

        function toggleIntervalMode() {
            const mode = document.getElementById('intervalMode').value;
            const fixedGroup = document.getElementById('fixedIntervalGroup');
            const randomGroup = document.getElementById('randomIntervalGroup');
            
            if (mode === 'fixed') {
                fixedGroup.style.display = 'flex';
                randomGroup.style.display = 'none';
            } else if (mode === 'random') {
                fixedGroup.style.display = 'none';
                randomGroup.style.display = 'none';
            } else if (mode === 'custom-random') {
                fixedGroup.style.display = 'none';
                randomGroup.style.display = 'flex';
            }
        }

        function getNextInterval() {
            if (currentTrainingMode === 'rounds') {
                // Vary combo timing based on round type
                const roundInfo = generator.getCurrentRoundInfo();
                if (roundInfo.type === 'defensive') {
                    return Math.floor(Math.random() * 3) + 4; // 4-6 seconds (slower, more methodical)
                } else if (roundInfo.type === 'intermediate') {
                    return Math.floor(Math.random() * 2) + 3; // 3-4 seconds (building pace)
                } else if (roundInfo.type === 'aggressive') {
                    return Math.floor(Math.random() * 2) + 2; // 2-3 seconds (fast, aggressive)
                }
                return 4;
            } else {
                const mode = document.getElementById('intervalMode').value;
                
                if (mode === 'fixed') {
                    return parseInt(document.getElementById('interval').value) || 5;
                } else if (mode === 'random') {
                    return Math.floor(Math.random() * 9) + 2; // 2-10 seconds
                } else if (mode === 'custom-random') {
                    const min = parseInt(document.getElementById('minInterval').value) || 2;
                    const max = parseInt(document.getElementById('maxInterval').value) || 10;
                    const actualMin = Math.min(min, max);
                    const actualMax = Math.max(min, max);
                    return Math.floor(Math.random() * (actualMax - actualMin + 1)) + actualMin;
                }
            }
            return 5;
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function startRoundTimer() {
            const roundDuration = parseInt(document.getElementById('roundDuration').value) || 3;
            roundTimeLeft = roundDuration * 60; // Convert to seconds
            
            const updateRoundTimer = () => {
                if (roundTimeLeft > 0) {
                    document.getElementById('roundTimeDisplay').textContent = formatTime(roundTimeLeft);
                    roundTimeLeft--;
                } else {
                    // Round completed
                    clearInterval(roundTimer);
                    finishRound();
                }
            };

            updateRoundTimer();
            roundTimer = setInterval(updateRoundTimer, 1000);
        }

        function finishRound() {
            clearInterval(trainingInterval);
            clearInterval(countdownInterval);
            isTraining = false;
            
            const isLastRound = generator.currentRound === 6;
            
            if (isLastRound) {
                // Training complete
                document.getElementById('comboText').textContent = 'üèÜ Training Complete! Excellent work, champion!';
                document.getElementById('timer').textContent = 'All 6 rounds completed. Take a well-deserved rest.';
                document.getElementById('startBtn').disabled = false;
                document.getElementById('stopBtn').disabled = true;
                document.getElementById('nextRoundBtn').style.display = 'none';
                document.getElementById('comboDisplay').classList.remove('training-mode');
                showStatus('üèÜ Training complete! You\'ve finished all 6 rounds!', 'success');
                generator.resetRounds();
                updateRoundDisplay();
            } else {
                // Start rest period
                startRestPeriod();
            }
        }

        function startRestPeriod() {
            isResting = true;
            const restDuration = parseInt(document.getElementById('restDuration').value) || 60;
            let restTimeLeft = restDuration;
            
            document.getElementById('comboText').textContent = `üí™ Round ${generator.currentRound} Complete!`;
            document.getElementById('timer').textContent = `Rest time: ${restTimeLeft}s`;
            document.getElementById('nextRoundBtn').style.display = 'inline-block';
            
            const restTimer = setInterval(() => {
                if (restTimeLeft > 0) {
                    document.getElementById('timer').textContent = `Rest time: ${restTimeLeft}s`;
                    restTimeLeft--;
                } else {
                    clearInterval(restTimer);
                    // Auto-advance to next round
                    nextRound();
                }
            }, 1000);
        }

        function nextRound() {
            if (generator.nextRound()) {
                isResting = false;
                updateRoundDisplay();
                document.getElementById('nextRoundBtn').style.display = 'none';
                
                // Show round start message
                const roundInfo = generator.getCurrentRoundInfo();
                document.getElementById('comboText').textContent = `Round ${generator.currentRound}: ${roundInfo.description}`;
                document.getElementById('timer').textContent = 'Get ready! Starting in 5 seconds...';
                
                setTimeout(() => {
                    if (!isResting) {
                        startRoundTraining();
                    }
                }, 5000);
            }
        }

        function startRoundTraining() {
            isTraining = true;
            document.getElementById('comboDisplay').classList.add('training-mode');
            
            showNextCombo();
            startRoundTimer();
            
            trainingInterval = setInterval(() => {
                if (!isResting) {
                    showNextCombo();
                }
            }, getNextInterval() * 1000);
        }

        function addCombo() {
            const newComboInput = document.getElementById('newCombo');
            const combo = newComboInput.value.trim();
            
            if (combo) {
                const result = generator.addCombo(combo);
                
                if (result) {
                    newComboInput.value = '';
                    updateComboList();
                    updateStatus();
                    showStatus(`‚úÖ Added: "${combo}"`, 'success');
                } else {
                    showStatus('‚ùå Combo already exists or is empty', 'error');
                }
            } else {
                showStatus('‚ùå Please enter a combo', 'error');
            }
        }

        function removeCombo(combo) {
            const result = generator.removeCombo(combo);
            
            if (result) {
                updateComboList();
                updateStatus();
                showStatus(`üóëÔ∏è Removed: "${combo}"`, 'success');
            } else {
                showStatus('‚ùå Cannot remove - need at least one combo', 'error');
            }
        }

        function updateComboList() {
            const combos = generator.getAllCombos();
            const comboList = document.getElementById('comboList');
            
            comboList.innerHTML = '';
            
            combos.forEach(combo => {
                const div = document.createElement('div');
                div.className = 'combo-item';
                div.innerHTML = `
                    <span>ü•ä ${combo}</span>
                    <button class="delete-btn" onclick="removeCombo('${combo.replace(/'/g, "\\'")}')">üóëÔ∏è Delete</button>
                `;
                comboList.appendChild(div);
            });
        }

        function updateStatus() {
            const count = generator.getComboCount();
            const statusText = `üìä Total custom combos: ${count}`;
            document.getElementById('status').textContent = statusText;
        }

        function resetCombos() {
            if (confirm('‚ö†Ô∏è This will reset all combos to defaults and remove your custom additions. Continue?')) {
                generator.resetToDefaults();
                updateComboList();
                updateStatus();
                showStatus('üîÑ Reset to default combos', 'success');
            }
        }

        function exportCombos() {
            const exported = generator.exportCombos();
            navigator.clipboard.writeText(exported).then(() => {
                showStatus('üì§ Combos copied to clipboard!', 'success');
            }).catch(() => {
                // Fallback for browsers that don't support clipboard API
                const textarea = document.createElement('textarea');
                textarea.value = exported;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showStatus('üì§ Combos copied to clipboard!', 'success');
            });
        }

        function showImportDialog() {
            const jsonInput = prompt('üì• Paste your exported combos JSON here:');
            if (jsonInput) {
                const success = generator.importCombos(jsonInput);
                if (success) {
                    updateComboList();
                    updateStatus();
                    showStatus('üì• Combos imported successfully!', 'success');
                } else {
                    showStatus('‚ùå Invalid format. Please check your JSON.', 'error');
                }
            }
        }

        function showStatus(message, type = 'info') {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            
            // Clear any existing timeout
            if (window.statusTimeout) {
                clearTimeout(window.statusTimeout);
            }
            
            // Reset to default status after 3 seconds
            window.statusTimeout = setTimeout(() => {
                updateStatus();
            }, 3000);
        }

        function showNextCombo() {
            const combo = generator.getRandomCombo(currentTrainingMode);
            const comboTextEl = document.getElementById('comboText');
            
            // Add fade out effect
            comboTextEl.style.opacity = '0';
            comboTextEl.style.transform = 'scale(0.8)';
            
            setTimeout(() => {
                comboTextEl.textContent = combo;
                comboTextEl.style.opacity = '1';
                comboTextEl.style.transform = 'scale(1)';
            }, 200);
            
            if (isTraining && currentTrainingMode === 'custom') {
                startCountdown();
            }
        }

        function startCountdown() {
            currentIntervalDuration = getNextInterval();
            timeLeft = currentIntervalDuration;
            
            clearInterval(countdownInterval);
            
            const mode = document.getElementById('intervalMode').value;
            const modeText = mode === 'fixed' ? '' : ` (${mode} mode)`;
            
            const updateTimer = () => {
                if (timeLeft > 0) {
                    document.getElementById('timer').textContent = `‚è±Ô∏è Next combo in: ${timeLeft}s${modeText}`;
                    timeLeft--;
                } else {
                    document.getElementById('timer').textContent = 'üîÑ Loading next combo...';
                }
            };
            
            updateTimer();
            countdownInterval = setInterval(updateTimer, 1000);
        }

        function startTraining() {
            if (currentTrainingMode === 'rounds') {
                const comboCount = Object.keys(generator.roundCombos).length;
                if (comboCount === 0) {
                    showStatus('‚ùå No round combos available', 'error');
                    return;
                }
                
                generator.resetRounds();
                updateRoundDisplay();
                
                isTraining = true;
                document.getElementById('startBtn').disabled = true;
                document.getElementById('stopBtn').disabled = false;
                
                showStatus('üöÄ Starting 6-round training! Begin when ready!', 'success');
                
                // Show round start message
                const roundInfo = generator.getCurrentRoundInfo();
                document.getElementById('comboText').textContent = `Round ${generator.currentRound}: ${roundInfo.description}`;
                document.getElementById('timer').textContent = 'Get ready! Starting in 5 seconds...';
                
                setTimeout(() => {
                    startRoundTraining();
                }, 5000);
                
            } else {
                const comboCount = generator.getComboCount();
                
                if (comboCount === 0) {
                    showStatus('‚ùå Please add at least one combo before starting training', 'error');
                    return;
                }
                
                isTraining = true;
                document.getElementById('startBtn').disabled = true;
                document.getElementById('stopBtn').disabled = false;
                document.getElementById('comboDisplay').classList.add('training-mode');
                
                showStatus('üöÄ Training started! Keep moving!', 'success');
                showNextCombo();
                
                const interval = getNextInterval();
                trainingInterval = setInterval(() => {
                    showNextCombo();
                }, interval * 1000);
            }
        }

        function stopTraining() {
            isTraining = false;
            isResting = false;
            clearInterval(trainingInterval);
            clearInterval(countdownInterval);
            clearInterval(roundTimer);
            
            document.getElementById('startBtn').disabled = false;
            document.getElementById('stopBtn').disabled = true;
            document.getElementById('nextRoundBtn').style.display = 'none';
            document.getElementById('comboDisplay').classList.remove('training-mode');
            document.getElementById('timer').textContent = '';
            document.getElementById('comboText').textContent = '‚èπÔ∏è Training stopped. Ready to start again!';
            
            if (currentTrainingMode === 'rounds') {
                document.getElementById('roundTimeDisplay').textContent = formatTime(parseInt(document.getElementById('roundDuration').value) * 60 || 180);
                generator.resetRounds();
                updateRoundDisplay();
            }
            
            showStatus('‚èπÔ∏è Training stopped. Great work!', 'info');
        }

        // Handle Enter key in the combo input
        document.getElementById('newCombo').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addCombo();
            }
        });

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            updateRoundDisplay();
            updateComboList();
            updateStatus();
            
            // Set initial round time display
            const roundDuration = parseInt(document.getElementById('roundDuration').value) || 3;
            document.getElementById('roundTimeDisplay').textContent = formatTime(roundDuration * 60);
            
            // Show welcome message for returning users
            const isReturningUser = localStorage.getItem('shadowboxing-combos');
            if (isReturningUser) {
                setTimeout(() => {
                    showStatus('üëã Welcome back! Your custom combos have been restored.', 'success');
                }, 500);
            }
        });

        // Update round time display when duration changes
        document.getElementById('roundDuration').addEventListener('change', function() {
            const duration = parseInt(this.value) || 3;
            document.getElementById('roundTimeDisplay').textContent = formatTime(duration * 60);
        });

        // Prevent accidental page refresh during training
        window.addEventListener('beforeunload', function(e) {
            if (isTraining) {
                e.preventDefault();
                e.returnValue = 'Training is in progress. Are you sure you want to leave?';
                return e.returnValue;
            }
        });
    </script>
</body>
</html>